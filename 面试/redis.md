## redis

### 数据类型使用场景

```
字符串:计数
hash:每人每天的提现次数
列表: 消息队列
无序集合:判断用户是否在列表中
有序集合:排行榜
```

### 数据类型的实现
```
字符串:常规key_value
hash:hash对应内部value实际就是一个HashMap。当hash的成员较少时，Redis为了节省内存会采用类似一维数组的方式来紧凑存储，当成员增大时会转为HashMap。
列表：列表的实现是一个双向链表，每个元素都是String，可以通过push和pop操作从列表的头部或尾部添加或删除元素，既可以作为栈，也可以作为队列。
无序列表：set的内部是value永远为null的HashMap，通过计算hash的方式来快速排重
有序列表：内部使用HashMap和跳跃表来保证数据的存储和有序
         HashMap里放的是成员到score的映射，跳跃表里放的是所有成员，排序依据是HashMap里存的score
         使用跳跃表的结构可以获得比较高的查找效率
```

### Redis高可用
```
1.数据持久化
    RDB：将Reids在内存中的数据库记录定时dump到磁盘上的RDB持久化
         占用空间小，有更快的重启恢复能力，但有数据丢失的风险
    AOF：将Reids的操作日志以追加的方式写入文件
         存储频率更高，丢失数据的风险低，不是二进制存储，可读性高，占用空间大，恢复速度较慢
2.主从复制
  可以实现数据读写分离，把写操作分发到主节点，读分到从节点，提高了redis的整体运行速度。
  宕机后，可以迅速把从节点升为主节点，降低了数据丢失的风险，数据是完整拷贝在多台服务器上的。
  主节点宕机后，必须人工介入手动恢复
3.哨兵机制
  监视主从服务器
  哨兵以1/s的频率向主和从发送ping，如果回复超过配置的最大下线时间，会被标记为主观下线，那么所有的哨兵节点会以1/s进行确认，标为客观下线，哨兵投票选出新的主节点并切换。
4.Redis集群：Redis3.0推出
  有多个主节点，同时每个主节点有多个从节点，将数据分布在不同的主服务器上，以此来降低系统对单主节点的依赖，提高Redis服务的读写性能
```
