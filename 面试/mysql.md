### 索引的优缺点
```
优点：提高查询速度
      加速表和表之间的连接
      减少查询中分组和排序的时间
缺点：索引需要占物理空间
      进行增删改的时候，索引也要动态的维护，降低了数据的维护速度
```

### 聚簇索引  一种数据存储方式
```
聚簇索引就是按照每张表的主键构造一颗B+树，同时叶子节点中存放的就是整张表的行记录数据，也将聚集索引的叶子节点称为数据页。这个特性决定了索引组织表中数据也是索引的一部分，每张表只能拥有一个聚簇索引。
（非聚簇索引是将数据与索引分开存储，索引结构的叶子节点指向了数据的对应行）
```

### 水平分表
```
RANGE:从0到10000一个表，10001到20000一个表；
HASH取模:一个商场系统，一般都是将用户，订单作为主表，然后将和它们相关的作为附表，这样不会造成跨库事务之类的问题。 取用户id，然后hash取模，分配到不同的数据库上。
地理区域:比如按照华东，华南，华北这样来区分业务，七牛云应该就是如此。
时间:按照时间切分，就是将6个月前，甚至一年前的数据切出去放到另外的一张表，因为随着时间流逝，这些表的数据 被查询的概率变小，所以没必要和“热数据”放在一起，这个也是“冷热数据分离”。
```

### 慢查询如何发现
```
set global slow_query_log = ON; # 打开慢查询日志
set global long_query_time = 1; # 超过1秒的语句被定义为慢语句
```

### 如何优化慢查询
```
当通过排查定位到慢查询sql后，就需要通过explain命令分析sql的执行计划并进行相应的优化
如果是因为没走索引，就要建合适的索引
如果是因为数据表太大，即使走了索引也依然很慢，这时要考虑分表
```

### 查询每个公司最早发行的文章
```
SELECT
 t.*
FROM
 (
  SELECT
   company,
   max(create_time) AS create_time
  FROM
   test
  GROUP BY
   company
 ) a
LEFT JOIN test t ON t.company = a.company
AND t.create_time = a.create_time
```